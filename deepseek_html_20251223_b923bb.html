<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢—Ä–∏ –≤ —Ä—è–¥ - –ü—Ä–æ—Ç–æ—Ç–∏–ø</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            background: black;
            color: #fff;
            min-height: 100vh;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .container {
            max-width: 800px;
            width: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            margin-top: 20px;
        }
        
        h1 {
            text-align: center;
            margin-bottom: 10px;
            color: #FFD700;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }
        
        .game-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            padding: 15px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            font-size: 1.2em;
        }
        
        .score, .moves {
            text-align: center;
        }
        
        .score-value, .moves-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #FFD700;
        }
        
        .game-board {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            gap: 5px;
            margin: 0 auto 25px;
            background-color: rgba(0, 0, 0, 0.3);
            padding: 10px;
            border-radius: 10px;
            max-width: 500px;
        }
        
        .cell {
            aspect-ratio: 1;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            font-size: 2em; /* –£–≤–µ–ª–∏—á–∏–º —Ä–∞–∑–º–µ—Ä —ç–º–æ–¥–∂–∏ */
            user-select: none;
            background-color: rgba(255, 255, 255, 0.15);
        }
        
        .cell:hover {
            transform: scale(1.05);
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
            background-color: rgba(255, 255, 255, 0.25);
        }
        
        .cell.selected {
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.9);
            transform: scale(1.05);
            background-color: rgba(255, 215, 0, 0.2);
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }
        
        button {
            padding: 12px 25px;
            background: linear-gradient(to bottom, #FFD700, #FF8C00);
            border: none;
            border-radius: 50px;
            color: #000;
            font-weight: bold;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
        }
        
        button:active {
            transform: translateY(1px);
        }
        
        .rules {
            margin-top: 25px;
            padding: 15px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            font-size: 0.95em;
            line-height: 1.5;
        }
        
        .rules h3 {
            color: #FFD700;
            margin-bottom: 10px;
        }
        
        .rules ul {
            padding-left: 20px;
        }
        
        .rules li {
            margin-bottom: 8px;
        }
        
        .message {
            text-align: center;
            margin-top: 15px;
            font-size: 1.2em;
            height: 30px;
            color: #FFD700;
        }
        
        @media (max-width: 600px) {
            .game-board {
                grid-template-columns: repeat(8, 1fr);
                gap: 4px;
            }
            
            .cell {
                font-size: 1.5em;
            }
            
            .controls {
                flex-direction: column;
                align-items: center;
            }
            
            button {
                width: 80%;
            }
        }
    </style>
</head>
<body>
    <h1>–¢—Ä–∏ –≤ —Ä—è–¥ - –ü—Ä–æ—Ç–æ—Ç–∏–ø</h1>
    
    <div class="container">
        <div class="game-info">
            <div class="score">
                <div>–°—á–µ—Ç</div>
                <div class="score-value">0</div>
            </div>
            <div class="moves">
                <div>–•–æ–¥—ã</div>
                <div class="moves-value">0</div>
            </div>
        </div>
        
        <div class="game-board" id="gameBoard">
            <!-- –ò–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ –±—É–¥–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ —á–µ—Ä–µ–∑ JavaScript -->
        </div>
        
        <div class="message" id="message"></div>
        
        <div class="controls">
            <button id="restartButton">–ù–æ–≤–∞—è –ò–ì–†–ê</button>
            <button id="hintButton">–ü–æ–¥—Å–∫–∞–∑–∫–∞!</button>
        </div>
        
        <div class="rules">
            <h3>–ü—Ä–∞–≤–∏–ª–∞ –∏–≥—Ä—ã:</h3>
            <ul>
                <li>–¶–µ–ª—å: —Å–æ–±–µ—Ä–∏—Ç–µ –ª–∏–Ω–∏–∏ –∏–∑ —Ç—Ä–µ—Ö –∏–ª–∏ –±–æ–ª–µ–µ –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö —Ñ—Ä—É–∫—Ç–æ–≤</li>
                <li>–ù–∞–∂–º–∏—Ç–µ –Ω–∞ —Ñ—Ä—É–∫—Ç, —á—Ç–æ–±—ã –≤—ã–¥–µ–ª–∏—Ç—å –µ–≥–æ, –∑–∞—Ç–µ–º –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ —Å–æ—Å–µ–¥–Ω–∏–π —Ñ—Ä—É–∫—Ç, —á—Ç–æ–±—ã –ø–æ–º–µ–Ω—è—Ç—å –∏—Ö –º–µ—Å—Ç–∞–º–∏</li>
                <li>–ï—Å–ª–∏ –ø–æ—Å–ª–µ –æ–±–º–µ–Ω–∞ –æ–±—Ä–∞–∑—É–µ—Ç—Å—è –ª–∏–Ω–∏—è –∏–∑ —Ç—Ä–µ—Ö –∏–ª–∏ –±–æ–ª–µ–µ –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö —Ñ—Ä—É–∫—Ç–æ–≤, –æ–Ω–∏ –∏—Å—á–µ–∑–Ω—É—Ç, –∏ –≤—ã –ø–æ–ª—É—á–∏—Ç–µ –æ—á–∫–∏</li>
                <li>–ò–≥—Ä–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è, –ø–æ–∫–∞ –µ—Å—Ç—å –≤–æ–∑–º–æ–∂–Ω—ã–µ —Ö–æ–¥—ã</li>
            </ul>
        </div>
    </div>

    <script>
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏–≥—Ä—ã
        const config = {
            rows: 8,
            cols: 8,
            // –¢–æ–ª—å–∫–æ 4 —Ç–∏–ø–∞ —Ñ—Ä—É–∫—Ç–æ–≤
            colors: ['üçé', 'üçå', 'üçá', 'üçä'],
            minMatch: 3,
            scorePerTile: 10,
            maxMoves: 30
        };
        
        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
        let gameState = {
            board: [],
            selectedCell: null,
            score: 0,
            moves: 0,
            gameOver: false
        };
        
        // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
        const gameBoard = document.getElementById('gameBoard');
        const scoreValue = document.querySelector('.score-value');
        const movesValue = document.querySelector('.moves-value');
        const messageEl = document.getElementById('message');
        const restartButton = document.getElementById('restartButton');
        const hintButton = document.getElementById('hintButton');
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
        function initGame() {
            gameState.board = [];
            gameState.selectedCell = null;
            gameState.score = 0;
            gameState.moves = 0;
            gameState.gameOver = false;
            
            // –°–æ–∑–¥–∞–µ–º –ø—É—Å—Ç–æ–µ –ø–æ–ª–µ
            for (let row = 0; row < config.rows; row++) {
                gameState.board[row] = [];
                for (let col = 0; col < config.cols; col++) {
                    gameState.board[row][col] = {
                        color: null,
                        row: row,
                        col: col
                    };
                }
            }
            
            // –ó–∞–ø–æ–ª–Ω—è–µ–º –ø–æ–ª–µ —Å–ª—É—á–∞–π–Ω—ã–º–∏ —Ñ–∏–≥—É—Ä–∞–º–∏
            fillBoard();
            
            // –£–±–∏—Ä–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è
            removeInitialMatches();
            
            // –û—Ç—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º –ø–æ–ª–µ
            renderBoard();
            updateUI();
            showMessage("–ò–≥—Ä–∞ –Ω–∞—á–∞–ª–∞—Å—å! –í—ã–±–µ—Ä–∏—Ç–µ —Ñ—Ä—É–∫—Ç –¥–ª—è –æ–±–º–µ–Ω–∞.");
        }
        
        // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–ª—è —Å–ª—É—á–∞–π–Ω—ã–º–∏ —Ñ–∏–≥—É—Ä–∞–º–∏
        function fillBoard() {
            for (let row = 0; row < config.rows; row++) {
                for (let col = 0; col < config.cols; col++) {
                    // –ù–∞–∑–Ω–∞—á–∞–µ–º —Å–ª—É—á–∞–π–Ω—ã–π —Ü–≤–µ—Ç
                    gameState.board[row][col].color = getRandomColor();
                }
            }
        }
        
        // –£–¥–∞–ª–µ–Ω–∏–µ –Ω–∞—á–∞–ª—å–Ω—ã—Ö —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π
        function removeInitialMatches() {
            let hasMatches = true;
            
            // –ü–æ–∫–∞ –µ—Å—Ç—å —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è, –∑–∞–º–µ–Ω—è–µ–º –∏—Ö –Ω–æ–≤—ã–º–∏ —Ñ–∏–≥—É—Ä–∞–º–∏
            while (hasMatches) {
                const matches = findAllMatches();
                if (matches.length === 0) {
                    hasMatches = false;
                } else {
                    // –ó–∞–º–µ–Ω—è–µ–º —Å–æ–≤–ø–∞–¥–∞—é—â–∏–µ —Ñ–∏–≥—É—Ä—ã
                    for (const match of matches) {
                        for (const tile of match.tiles) {
                            gameState.board[tile.row][tile.col].color = getRandomColor();
                        }
                    }
                }
            }
        }
        
        // –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ª—É—á–∞–π–Ω–æ–≥–æ —Ü–≤–µ—Ç–∞
        function getRandomColor() {
            return config.colors[Math.floor(Math.random() * config.colors.length)];
        }
        
        // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –∏–≥—Ä–æ–≤–æ–≥–æ –ø–æ–ª—è
        function renderBoard() {
            gameBoard.innerHTML = '';
            gameBoard.style.gridTemplateColumns = `repeat(${config.cols}, 1fr)`;
            
            for (let row = 0; row < config.rows; row++) {
                for (let col = 0; col < config.cols; col++) {
                    const tile = gameState.board[row][col];
                    const cell = document.createElement('div');
                    cell.className = 'cell';
                    cell.dataset.row = row;
                    cell.dataset.col = col;
                    cell.textContent = tile.color;
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞
                    cell.addEventListener('click', () => handleCellClick(row, col));
                    
                    gameBoard.appendChild(cell);
                }
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –≤—ã–¥–µ–ª–µ–Ω–Ω—É—é —è—á–µ–π–∫—É
            if (gameState.selectedCell) {
                const {row, col} = gameState.selectedCell;
                const selectedCell = document.querySelector(`.cell[data-row="${row}"][data-col="${col}"]`);
                if (selectedCell) {
                    selectedCell.classList.add('selected');
                }
            }
        }
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–∞ –ø–æ —è—á–µ–π–∫–µ
        function handleCellClick(row, col) {
            if (gameState.gameOver) return;
            
            // –ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –≤—ã–±—Ä–∞–Ω–æ, –≤—ã–±–∏—Ä–∞–µ–º —ç—Ç—É —è—á–µ–π–∫—É
            if (!gameState.selectedCell) {
                gameState.selectedCell = {row, col};
                renderBoard();
                showMessage(`–í—ã–±—Ä–∞–Ω —Ñ—Ä—É–∫—Ç. –¢–µ–ø–µ—Ä—å –≤—ã–±–µ—Ä–∏—Ç–µ —Å–æ—Å–µ–¥–Ω–∏–π —Ñ—Ä—É–∫—Ç –¥–ª—è –æ–±–º–µ–Ω–∞.`);
                return;
            }
            
            const selectedRow = gameState.selectedCell.row;
            const selectedCol = gameState.selectedCell.col;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –≤—ã–±—Ä–∞–Ω–Ω–∞—è —è—á–µ–π–∫–∞ —Å–æ—Å–µ–¥–Ω–µ–π
            const isAdjacent = Math.abs(row - selectedRow) + Math.abs(col - selectedCol) === 1;
            
            if (!isAdjacent) {
                // –ï—Å–ª–∏ —è—á–µ–π–∫–∞ –Ω–µ —Å–æ—Å–µ–¥–Ω—è—è, –ø—Ä–æ—Å—Ç–æ –≤—ã–±–∏—Ä–∞–µ–º –Ω–æ–≤—É—é
                gameState.selectedCell = {row, col};
                renderBoard();
                showMessage(`–í—ã–±—Ä–∞–Ω –¥—Ä—É–≥–æ–π —Ñ—Ä—É–∫—Ç. –¢–µ–ø–µ—Ä—å –≤—ã–±–µ—Ä–∏—Ç–µ —Å–æ—Å–µ–¥–Ω–∏–π —Ñ—Ä—É–∫—Ç –¥–ª—è –æ–±–º–µ–Ω–∞.`);
                return;
            }
            
            // –ú–µ–Ω—è–µ–º —Ñ–∏–≥—É—Ä—ã –º–µ—Å—Ç–∞–º–∏
            swapTiles(selectedRow, selectedCol, row, col);
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –ø–æ—Å–ª–µ –æ–±–º–µ–Ω–∞
            const matches = findAllMatches();
            
            if (matches.length === 0) {
                // –ï—Å–ª–∏ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π –Ω–µ—Ç, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —Ñ–∏–≥—É—Ä—ã –Ω–∞ –º–µ—Å—Ç–æ
                swapTiles(selectedRow, selectedCol, row, col);
                gameState.selectedCell = null;
                renderBoard();
                showMessage("–ù–µ –æ–±—Ä–∞–∑–æ–≤–∞–ª–æ—Å—å –ª–∏–Ω–∏–π. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥–æ–π –æ–±–º–µ–Ω.");
            } else {
                // –ï—Å–ª–∏ –µ—Å—Ç—å —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∏—Ö
                gameState.selectedCell = null;
                gameState.moves++;
                processMatches(matches);
                showMessage(`–û—Ç–ª–∏—á–Ω–æ! –í—ã –Ω–∞–±—Ä–∞–ª–∏ –æ—á–∫–∏ –∑–∞ —Å–æ–±—Ä–∞–Ω–Ω—ã–µ –ª–∏–Ω–∏–∏.`);
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –∑–∞–∫–æ–Ω—á–∏–ª–∞—Å—å –ª–∏ –∏–≥—Ä–∞
                checkGameOver();
            }
            
            updateUI();
        }
        
        // –û–±–º–µ–Ω –¥–≤—É—Ö —Ñ–∏–≥—É—Ä –º–µ—Å—Ç–∞–º–∏
        function swapTiles(row1, col1, row2, col2) {
            const temp = gameState.board[row1][col1].color;
            gameState.board[row1][col1].color = gameState.board[row2][col2].color;
            gameState.board[row2][col2].color = temp;
        }
        
        // –ü–æ–∏—Å–∫ –≤—Å–µ—Ö —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π –Ω–∞ –ø–æ–ª–µ
        function findAllMatches() {
            const matches = [];
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã—Ö —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π
            for (let row = 0; row < config.rows; row++) {
                for (let col = 0; col < config.cols - 2; col++) {
                    const color = gameState.board[row][col].color;
                    if (color && 
                        color === gameState.board[row][col+1].color && 
                        color === gameState.board[row][col+2].color) {
                        
                        // –†–∞—Å—à–∏—Ä—è–µ–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ, –µ—Å–ª–∏ –µ—Å—Ç—å –±–æ–ª–µ–µ 3 —Ñ–∏–≥—É—Ä –≤ —Ä—è–¥
                        let matchEnd = col + 2;
                        while (matchEnd + 1 < config.cols && 
                               gameState.board[row][matchEnd+1].color === color) {
                            matchEnd++;
                        }
                        
                        const tiles = [];
                        for (let c = col; c <= matchEnd; c++) {
                            tiles.push({row, col: c});
                        }
                        
                        matches.push({
                            color: color,
                            tiles: tiles,
                            direction: 'horizontal'
                        });
                        
                        col = matchEnd; // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —É–∂–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ —è—á–µ–π–∫–∏
                    }
                }
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã—Ö —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π
            for (let col = 0; col < config.cols; col++) {
                for (let row = 0; row < config.rows - 2; row++) {
                    const color = gameState.board[row][col].color;
                    if (color && 
                        color === gameState.board[row+1][col].color && 
                        color === gameState.board[row+2][col].color) {
                        
                        // –†–∞—Å—à–∏—Ä—è–µ–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ, –µ—Å–ª–∏ –µ—Å—Ç—å –±–æ–ª–µ–µ 3 —Ñ–∏–≥—É—Ä –≤ —Ä—è–¥
                        let matchEnd = row + 2;
                        while (matchEnd + 1 < config.rows && 
                               gameState.board[matchEnd+1][col].color === color) {
                            matchEnd++;
                        }
                        
                        const tiles = [];
                        for (let r = row; r <= matchEnd; r++) {
                            tiles.push({row: r, col});
                        }
                        
                        matches.push({
                            color: color,
                            tiles: tiles,
                            direction: 'vertical'
                        });
                        
                        row = matchEnd; // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —É–∂–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ —è—á–µ–π–∫–∏
                    }
                }
            }
            
            return matches;
        }
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π
        function processMatches(matches) {
            // –°–æ–±–∏—Ä–∞–µ–º –≤—Å–µ —è—á–µ–π–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å
            const tilesToRemove = [];
            for (const match of matches) {
                for (const tile of match.tiles) {
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ª–∏ —É–∂–µ —ç—Ç–∞ —è—á–µ–π–∫–∞
                    if (!tilesToRemove.some(t => t.row === tile.row && t.col === tile.col)) {
                        tilesToRemove.push(tile);
                    }
                }
            }
            
            // –£–¥–∞–ª—è–µ–º —Ñ–∏–≥—É—Ä—ã
            for (const tile of tilesToRemove) {
                gameState.board[tile.row][tile.col].color = null;
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ—á–∫–∏
            gameState.score += tilesToRemove.length * config.scorePerTile;
            
            // –ê–Ω–∏–º–∏—Ä—É–µ–º —É–¥–∞–ª–µ–Ω–∏–µ
            renderBoard();
            
            // –ó–∞–ø–æ–ª–Ω—è–µ–º –ø—É—Å—Ç—ã–µ –º–µ—Å—Ç–∞ –Ω–æ–≤—ã–º–∏ —Ñ–∏–≥—É—Ä–∞–º–∏
            setTimeout(() => {
                dropTiles();
                fillEmptySpaces();
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –ø–æ—è–≤–∏–ª–∏—Å—å –ª–∏ –Ω–æ–≤—ã–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –ø–æ—Å–ª–µ –ø–∞–¥–µ–Ω–∏—è
                const newMatches = findAllMatches();
                if (newMatches.length > 0) {
                    // –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –Ω–æ–≤—ã–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è
                    setTimeout(() => {
                        processMatches(newMatches);
                        showMessage("–ö–æ–º–±–æ! –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ª–∏–Ω–∏–∏!");
                    }, 500);
                }
            }, 500);
        }
        
        // –ü–∞–¥–µ–Ω–∏–µ —Ñ–∏–≥—É—Ä –≤–Ω–∏–∑
        function dropTiles() {
            for (let col = 0; col < config.cols; col++) {
                let emptyRow = config.rows - 1;
                
                // –ò–¥–µ–º —Å–Ω–∏–∑—É –≤–≤–µ—Ä—Ö
                for (let row = config.rows - 1; row >= 0; row--) {
                    if (gameState.board[row][col].color !== null) {
                        // –ï—Å–ª–∏ —Ç–µ–∫—É—â–∞—è —è—á–µ–π–∫–∞ –Ω–µ –ø—É—Å—Ç–∞, –ø–µ—Ä–µ–º–µ—â–∞–µ–º –µ–µ –≤–Ω–∏–∑
                        if (row !== emptyRow) {
                            gameState.board[emptyRow][col].color = gameState.board[row][col].color;
                            gameState.board[row][col].color = null;
                        }
                        emptyRow--;
                    }
                }
            }
        }
        
        // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—É—Å—Ç—ã—Ö –º–µ—Å—Ç –Ω–æ–≤—ã–º–∏ —Ñ–∏–≥—É—Ä–∞–º–∏
        function fillEmptySpaces() {
            for (let row = 0; row < config.rows; row++) {
                for (let col = 0; col < config.cols; col++) {
                    if (gameState.board[row][col].color === null) {
                        gameState.board[row][col].color = getRandomColor();
                    }
                }
            }
            
            renderBoard();
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è –∏–≥—Ä—ã
        function checkGameOver() {
            // –ò–≥—Ä–∞ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è, –µ—Å–ª–∏ –∑–∞–∫–æ–Ω—á–∏–ª–∏—Å—å —Ö–æ–¥—ã
            if (gameState.moves >= config.maxMoves) {
                gameState.gameOver = true;
                showMessage(`–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞! –í–∞—à —Å—á–µ—Ç: ${gameState.score}`);
            }
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        function updateUI() {
            scoreValue.textContent = gameState.score;
            movesValue.textContent = `${gameState.moves} / ${config.maxMoves}`;
        }
        
        // –ü–æ–∫–∞–∑ —Å–æ–æ–±—â–µ–Ω–∏–π
        function showMessage(text) {
            messageEl.textContent = text;
        }
        
        // –ü–æ–∏—Å–∫ –ø–æ–¥—Å–∫–∞–∑–∫–∏ (–¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ —Ö–æ–¥–∞)
        function findHint() {
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–æ—Å–∫–∏
            const originalBoard = JSON.parse(JSON.stringify(gameState.board));
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –æ–±–º–µ–Ω—ã —Å–æ—Å–µ–¥–Ω–∏—Ö —Ñ–∏–≥—É—Ä
            for (let row = 0; row < config.rows; row++) {
                for (let col = 0; col < config.cols; col++) {
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ–±–º–µ–Ω —Å –ø—Ä–∞–≤–æ–π —Ñ–∏–≥—É—Ä–æ–π
                    if (col < config.cols - 1) {
                        swapTiles(row, col, row, col + 1);
                        const matches = findAllMatches();
                        // –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Ñ–∏–≥—É—Ä—ã –Ω–∞ –º–µ—Å—Ç–æ
                        swapTiles(row, col, row, col + 1);
                        
                        if (matches.length > 0) {
                            return {row1: row, col1: col, row2: row, col2: col + 1};
                        }
                    }
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ–±–º–µ–Ω —Å –Ω–∏–∂–Ω–µ–π —Ñ–∏–≥—É—Ä–æ–π
                    if (row < config.rows - 1) {
                        swapTiles(row, col, row + 1, col);
                        const matches = findAllMatches();
                        // –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Ñ–∏–≥—É—Ä—ã –Ω–∞ –º–µ—Å—Ç–æ
                        swapTiles(row, col, row + 1, col);
                        
                        if (matches.length > 0) {
                            return {row1: row, col1: col, row2: row + 1, col2: col};
                        }
                    }
                }
            }
            
            // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏—Å—Ö–æ–¥–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–æ—Å–∫–∏
            gameState.board = originalBoard;
            return null;
        }
        
        // –ü–æ–∫–∞–∑ –ø–æ–¥—Å–∫–∞–∑–∫–∏
        function showHint() {
            if (gameState.gameOver) return;
            
            const hint = findHint();
            if (hint) {
                // –ü–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º –ø–æ–¥—Å–∫–∞–∑–∫—É
                const cell1 = document.querySelector(`.cell[data-row="${hint.row1}"][data-col="${hint.col1}"]`);
                const cell2 = document.querySelector(`.cell[data-row="${hint.row2}"][data-col="${hint.col2}"]`);
                
                if (cell1 && cell2) {
                    // –°–Ω–∏–º–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –≤—ã–¥–µ–ª–µ–Ω–∏—è
                    document.querySelectorAll('.cell').forEach(cell => {
                        cell.classList.remove('selected');
                    });
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ –¥–ª—è –ø–æ–¥—Å–∫–∞–∑–∫–∏
                    cell1.classList.add('selected');
                    cell2.classList.add('selected');
                    
                    showMessage(`–ü–æ–¥—Å–∫–∞–∑–∫–∞: –ø–æ–º–µ–Ω—è–π—Ç–µ –º–µ—Å—Ç–∞–º–∏ —ç—Ç–∏ –¥–≤–∞ —Ñ—Ä—É–∫—Ç–∞`);
                    
                    // –£–±–∏—Ä–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
                    setTimeout(() => {
                        cell1.classList.remove('selected');
                        cell2.classList.remove('selected');
                        gameState.selectedCell = null;
                        showMessage("–ü–æ–¥—Å–∫–∞–∑–∫–∞ –∏—Å—á–µ–∑–ª–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–∞–º–∏!");
                    }, 3000);
                }
            } else {
                showMessage("–ü–æ–¥—Å–∫–∞–∑–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞. –í–æ–∑–º–æ–∂–Ω–æ, —Ö–æ–¥–æ–≤ –±–æ–ª—å—à–µ –Ω–µ—Ç.");
            }
        }
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫
        restartButton.addEventListener('click', initGame);
        hintButton.addEventListener('click', showHint);
        
        // –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('DOMContentLoaded', initGame);
    </script>
</body>
</html>