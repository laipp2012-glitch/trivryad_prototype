<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢—Ä–∏ –≤ —Ä—è–¥ - –§—Ä—É–∫—Ç–æ–≤—ã–π –º–∞—Ç—á</title>
    <style>
        /* ============================================
           –û–°–ù–û–í–ù–´–ï –ù–ê–°–¢–†–û–ô–ö–ò –°–¢–†–ê–ù–ò–¶–´
           ============================================ */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0f0f23 0%, #1a1a2e 100%);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow-x: hidden;
        }
        
        /* ============================================
           –ö–û–ù–¢–ï–ô–ù–ï–† –ò –ó–ê–ì–û–õ–û–í–û–ö
           ============================================ */
        .container {
            max-width: 800px;
            width: 100%;
            background: rgba(25, 25, 35, 0.9);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.7);
            margin-top: 20px;
            position: relative;
            z-index: 1;
            border: 1px solid rgba(255, 215, 0, 0.2);
        }
        
        h1 {
            text-align: center;
            margin-bottom: 15px;
            color: #FFD700;
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
            font-size: 2.8em;
            background: linear-gradient(45deg, #FFD700, #FF8C00);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        /* ============================================
           –ò–ù–§–û–†–ú–ê–¶–ò–Ø –û–ë –ò–ì–†–ï (–°–ß–ï–¢ –ò –•–û–î–´)
           ============================================ */
        .game-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 25px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.08);
            border-radius: 15px;
            font-size: 1.2em;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .score, .moves {
            text-align: center;
            flex: 1;
        }
        
        .score-value, .moves-value {
            font-size: 2em;
            font-weight: bold;
            color: #FFD700;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.7);
        }
        
        /* ============================================
           –ò–ì–†–û–í–û–ï –ü–û–õ–ï 8x8
           ============================================ */
        .game-board {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            gap: 8px;
            margin: 0 auto 30px;
            background: rgba(0, 0, 0, 0.4);
            padding: 15px;
            border-radius: 15px;
            max-width: 500px;
            position: relative;
            border: 2px solid rgba(255, 215, 0, 0.3);
        }
        
        /* ============================================
           –Ø–ß–ï–ô–ö–ò –° –§–†–£–ö–¢–ê–ú–ò
           ============================================ */
        .cell {
            aspect-ratio: 1;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            font-size: 1.8em;
            user-select: none;
            background: rgba(255, 255, 255, 0.1);
            position: relative;
            overflow: hidden;
            border: 2px solid transparent;
        }
        
        /* –¶–≤–µ—Ç–æ–≤—ã–µ –∞–∫—Ü–µ–Ω—Ç—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ñ—Ä—É–∫—Ç–æ–≤ */
        .cell[data-fruit="üçé"] { background: rgba(255, 0, 0, 0.2); }
        .cell[data-fruit="üçå"] { background: rgba(255, 255, 0, 0.2); }
        .cell[data-fruit="üçá"] { background: rgba(128, 0, 128, 0.2); }
        .cell[data-fruit="üçä"] { background: rgba(255, 165, 0, 0.2); }
        
        .cell:hover {
            transform: scale(1.08);
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.4);
        }
        
        /* –í—ã–¥–µ–ª–µ–Ω–Ω—ã–π —Ñ—Ä—É–∫—Ç */
        .cell.selected {
            box-shadow: 0 0 30px rgba(255, 215, 0, 1);
            transform: scale(1.1);
            border-color: #FFD700;
            animation: pulse 1.2s infinite;
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 20px rgba(255, 215, 0, 1); }
            50% { box-shadow: 0 0 40px rgba(255, 215, 0, 0.6); }
            100% { box-shadow: 0 0 20px rgba(255, 215, 0, 1); }
        }
        
        /* ============================================
           –ö–ù–û–ü–ö–ò –£–ü–†–ê–í–õ–ï–ù–ò–Ø
           ============================================ */
        .controls {
            display: flex;
            justify-content: center;
            gap: 25px;
            margin-top: 25px;
        }
        
        button {
            padding: 15px 35px;
            background: linear-gradient(145deg, #FFD700, #FF8C00);
            border: none;
            border-radius: 50px;
            color: #000;
            font-weight: bold;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
            display: flex;
            align-items: center;
            gap: 10px;
            min-width: 180px;
            justify-content: center;
        }
        
        button:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 25px rgba(0, 0, 0, 0.5);
            background: linear-gradient(145deg, #FFE44D, #FFA500);
        }
        
        button:active {
            transform: translateY(-2px);
        }
        
        /* ============================================
           –ë–õ–û–ö –° –ü–†–ê–í–ò–õ–ê–ú–ò
           ============================================ */
        .rules {
            margin-top: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.08);
            border-radius: 15px;
            font-size: 1em;
            line-height: 1.6;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .rules h3 {
            color: #FFD700;
            margin-bottom: 15px;
            font-size: 1.3em;
        }
        
        .rules ul {
            padding-left: 25px;
            list-style: none;
        }
        
        .rules li {
            margin-bottom: 10px;
            padding-left: 10px;
            position: relative;
        }
        
        .rules li:before {
            content: "‚ñ∂";
            color: #FFD700;
            position: absolute;
            left: -15px;
        }
        
        /* ============================================
           –°–û–û–ë–©–ï–ù–ò–Ø –ò–ì–†–´
           ============================================ */
        .message {
            text-align: center;
            margin-top: 20px;
            font-size: 1.3em;
            height: 40px;
            color: #FFD700;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 215, 0, 0.1);
            border-radius: 10px;
            padding: 5px 15px;
        }
        
        /* ============================================
           –ê–ù–ò–ú–ê–¶–ò–ò
           ============================================ */
        /* –ß–∞—Å—Ç–∏—Ü—ã –ø—Ä–∏ –≤–∑—Ä—ã–≤–µ */
        .particle {
            position: fixed;
            pointer-events: none;
            z-index: 1000;
            font-size: 1.5em;
            animation: particleExplode 0.8s forwards;
        }
        
        @keyframes particleExplode {
            0% {
                opacity: 1;
                transform: translate(0, 0) scale(1) rotate(0deg);
            }
            100% {
                opacity: 0;
                transform: translate(var(--tx), var(--ty)) scale(0.1) rotate(var(--rot));
            }
        }
        
        /* –ê–Ω–∏–º–∞—Ü–∏—è "–ú–ê–¢–ß!" */
        .match-animation {
            position: absolute;
            font-size: 2.8em;
            font-weight: bold;
            color: #FFD700;
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.9);
            opacity: 0;
            z-index: 100;
            animation: matchFloat 0.8s ease-out forwards;
        }
        
        @keyframes matchFloat {
            0% {
                opacity: 0;
                transform: translateY(0) scale(0.5);
            }
            30% {
                opacity: 1;
                transform: translateY(-30px) scale(1.3);
            }
            100% {
                opacity: 0;
                transform: translateY(-60px) scale(1);
            }
        }
        
        /* –ê–Ω–∏–º–∞—Ü–∏—è –∫–æ–º–±–æ */
        .combo-text {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 5em;
            font-weight: bold;
            color: #FFD700;
            text-shadow: 0 0 30px rgba(255, 215, 0, 0.9);
            opacity: 0;
            z-index: 1001;
            pointer-events: none;
            animation: comboBounce 1.2s ease-out;
        }
        
        @keyframes comboBounce {
            0% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.2);
            }
            20% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1.6);
            }
            40% {
                transform: translate(-50%, -50%) scale(0.9);
            }
            60% {
                transform: translate(-50%, -50%) scale(1.1);
            }
            80% {
                transform: translate(-50%, -50%) scale(0.95);
            }
            100% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(1);
            }
        }
        
        /* –í–∑—Ä—ã–≤ —è—á–µ–π–∫–∏ */
        .cell.exploding {
            animation: cellExplode 0.4s ease-out forwards;
        }
        
        @keyframes cellExplode {
            0% {
                transform: scale(1);
                opacity: 1;
            }
            50% {
                transform: scale(1.3);
                opacity: 0.8;
            }
            100% {
                transform: scale(0);
                opacity: 0;
            }
        }
        
        /* –ê–Ω–∏–º–∞—Ü–∏—è –æ–±–º–µ–Ω–∞ */
        .swapping {
            animation: swapAnimation 0.25s ease-out;
        }
        
        @keyframes swapAnimation {
            0% { transform: scale(1); }
            50% { transform: scale(1.15); }
            100% { transform: scale(1); }
        }
        
        /* ============================================
           –ê–î–ê–ü–¢–ò–í–ù–û–°–¢–¨ –î–õ–Ø –ú–û–ë–ò–õ–¨–ù–´–• –£–°–¢–†–û–ô–°–¢–í
           ============================================ */
        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            
            h1 {
                font-size: 2em;
            }
            
            .game-board {
                grid-template-columns: repeat(8, 1fr);
                gap: 6px;
                padding: 10px;
            }
            
            .cell {
                font-size: 1.4em;
                border-radius: 8px;
            }
            
            .controls {
                flex-direction: column;
                align-items: center;
                gap: 15px;
            }
            
            button {
                width: 100%;
                max-width: 300px;
                padding: 12px 25px;
            }
            
            .game-info {
                flex-direction: column;
                gap: 15px;
            }
            
            .combo-text {
                font-size: 3em;
            }
            
            .match-animation {
                font-size: 2em;
            }
        }
        
        @media (max-width: 480px) {
            .game-board {
                gap: 4px;
            }
            
            .cell {
                font-size: 1.2em;
            }
            
            .score-value, .moves-value {
                font-size: 1.5em;
            }
        }
    </style>
</head>
<body>
    <h1>üçé –§—Ä—É–∫—Ç–æ–≤—ã–π –º–∞—Ç—á üçå</h1>
    
    <div class="container">
        <!-- –ò–ù–§–û–†–ú–ê–¶–ò–Ø –û–ë –ò–ì–†–ï -->
        <div class="game-info">
            <div class="score">
                <div>üçì –°—á–µ—Ç</div>
                <div class="score-value">0</div>
            </div>
            <div class="moves">
                <div>üéÆ –•–æ–¥—ã</div>
                <div class="moves-value">0 / 30</div>
            </div>
        </div>
        
        <!-- –ò–ì–†–û–í–û–ï –ü–û–õ–ï -->
        <div class="game-board" id="gameBoard">
            <!-- –ó–¥–µ—Å—å –ø–æ—è–≤—è—Ç—Å—è —Ñ—Ä—É–∫—Ç—ã -->
        </div>
        
        <!-- –°–û–û–ë–©–ï–ù–ò–Ø –ò–ì–†–´ -->
        <div class="message" id="message">–í—ã–±–µ—Ä–∏—Ç–µ –ø–µ—Ä–≤—ã–π —Ñ—Ä—É–∫—Ç!</div>
        
        <!-- –ö–ù–û–ü–ö–ò –£–ü–†–ê–í–õ–ï–ù–ò–Ø -->
        <div class="controls">
            <button id="restartButton">
                <span>üîÑ</span>
                <span>–ù–æ–≤–∞—è –∏–≥—Ä–∞</span>
            </button>
            <button id="hintButton">
                <span>üí°</span>
                <span>–ü–æ–¥—Å–∫–∞–∑–∫–∞</span>
            </button>
        </div>
        
        <!-- –ü–†–ê–í–ò–õ–ê –ò–ì–†–´ -->
        <div class="rules">
            <h3>üéØ –ö–∞–∫ –∏–≥—Ä–∞—Ç—å:</h3>
            <ul>
                <li><strong>–¶–µ–ª—å:</strong> –°–æ–±–∏—Ä–∞–π—Ç–µ –ª–∏–Ω–∏–∏ –∏–∑ 3+ –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö —Ñ—Ä—É–∫—Ç–æ–≤</li>
                <li><strong>–•–æ–¥:</strong> –ù–∞–∂–º–∏—Ç–µ –Ω–∞ —Ñ—Ä—É–∫—Ç, –∑–∞—Ç–µ–º –Ω–∞ —Å–æ—Å–µ–¥–Ω–∏–π —Ñ—Ä—É–∫—Ç</li>
                <li><strong>–í–∑—Ä—ã–≤:</strong> –°–æ–±—Ä–∞–Ω–Ω—ã–µ –ª–∏–Ω–∏–∏ –≤–∑—Ä—ã–≤–∞—é—Ç—Å—è —Å —ç—Ñ—Ñ–µ–∫—Ç–∞–º–∏!</li>
                <li><strong>–û–∫–æ–Ω—á–∞–Ω–∏–µ:</strong> –ò–≥—Ä–∞ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ 30 —Ö–æ–¥–æ–≤</li>
            </ul>
        </div>
    </div>

    <script>
        // ============================================
        // –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø –ò–ì–†–´ - –í–°–ï –ù–ê–°–¢–†–û–ô–ö–ò –ó–î–ï–°–¨
        // ============================================
        const CONFIG = {
            ROWS: 8,
            COLS: 8,
            FRUITS: ['üçé', 'üçå', 'üçá', 'üçä', 'üçì', 'üçí'], // –î–æ–±–∞–≤–∏–ª –±–æ–ª—å—à–µ —Ñ—Ä—É–∫—Ç–æ–≤
            MIN_MATCH: 3,
            SCORE_PER_FRUIT: 10,
            MAX_MOVES: 30,
            ANIMATION_SPEED: {
                SWAP: 200,
                EXPLODE: 400,
                DROP: 500,
                PARTICLE: 700
            }
        };

        // ============================================
        // –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï –ò –°–û–°–¢–û–Ø–ù–ò–ï –ò–ì–†–´
        // ============================================
        const state = {
            board: [],
            selectedCell: null,
            score: 0,
            moves: 0,
            isGameOver: false,
            combo: 0,
            isAnimating: false
        };

        // ============================================
        // –ü–û–õ–£–ß–ï–ù–ò–ï –≠–õ–ï–ú–ï–ù–¢–û–í DOM - –í–°–ï –≠–õ–ï–ú–ï–ù–¢–´ –ó–î–ï–°–¨
        // ============================================
        const DOM = {
            gameBoard: document.getElementById('gameBoard'),
            scoreValue: document.querySelector('.score-value'),
            movesValue: document.querySelector('.moves-value'),
            message: document.getElementById('message'),
            restartButton: document.getElementById('restartButton'),
            hintButton: document.getElementById('hintButton')
        };

        // ============================================
        // –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò
        // ============================================

        // –ü–æ–ª—É—á–∏—Ç—å —Å–ª—É—á–∞–π–Ω—ã–π —Ñ—Ä—É–∫—Ç
        function getRandomFruit() {
            return CONFIG.FRUITS[Math.floor(Math.random() * CONFIG.FRUITS.length)];
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
        function showMessage(text) {
            DOM.message.textContent = text;
        }

        // –û–±–Ω–æ–≤–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—á–µ—Ç–∞
        function updateUI() {
            DOM.scoreValue.textContent = state.score;
            DOM.movesValue.textContent = `${state.moves} / ${CONFIG.MAX_MOVES}`;
        }

        // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ—Å–µ–¥–Ω–∏–µ –ª–∏ –∫–ª–µ—Ç–∫–∏
        function areNeighbors(cell1, cell2) {
            return Math.abs(cell1.row - cell2.row) + Math.abs(cell1.col - cell2.col) === 1;
        }

        // ============================================
        // –û–°–ù–û–í–ù–´–ï –§–£–ù–ö–¶–ò–ò –ò–ì–†–´
        // ============================================

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –Ω–æ–≤–æ–π –∏–≥—Ä—ã
        function initGame() {
            console.log("üöÄ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –Ω–æ–≤–æ–π –∏–≥—Ä—ã...");
            
            // –°–±—Ä–æ—Å —Å–æ—Å—Ç–æ—è–Ω–∏—è
            Object.assign(state, {
                board: [],
                selectedCell: null,
                score: 0,
                moves: 0,
                isGameOver: false,
                combo: 0,
                isAnimating: false
            });

            // –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—è
            createBoard();
            
            // –£–¥–∞–ª–µ–Ω–∏–µ –Ω–∞—á–∞–ª—å–Ω—ã—Ö —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π
            removeInitialMatches();
            
            // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
            renderBoard();
            updateUI();
            
            showMessage("üéÆ –ò–≥—Ä–∞ –Ω–∞—á–∞–ª–∞—Å—å! –í—ã–±–µ—Ä–∏—Ç–µ –ø–µ—Ä–≤—ã–π —Ñ—Ä—É–∫—Ç");
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ –∏–≥—Ä–æ–≤–æ–≥–æ –ø–æ–ª—è
        function createBoard() {
            state.board = [];
            for (let row = 0; row < CONFIG.ROWS; row++) {
                state.board[row] = [];
                for (let col = 0; col < CONFIG.COLS; col++) {
                    state.board[row][col] = {
                        fruit: getRandomFruit(),
                        row,
                        col
                    };
                }
            }
        }

        // –£–¥–∞–ª–µ–Ω–∏–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –∏–≥—Ä—ã
        function removeInitialMatches() {
            let hasMatches = true;
            while (hasMatches) {
                const matches = findMatches();
                if (matches.length === 0) {
                    hasMatches = false;
                } else {
                    matches.forEach(match => {
                        match.tiles.forEach(tile => {
                            state.board[tile.row][tile.col].fruit = getRandomFruit();
                        });
                    });
                }
            }
        }

        // –ü–æ–∏—Å–∫ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π –Ω–∞ –ø–æ–ª–µ
        function findMatches() {
            const matches = [];
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã—Ö –ª–∏–Ω–∏–π
            for (let row = 0; row < CONFIG.ROWS; row++) {
                for (let col = 0; col < CONFIG.COLS - 2; col++) {
                    const fruit = state.board[row][col].fruit;
                    if (!fruit) continue;
                    
                    if (state.board[row][col + 1].fruit === fruit && 
                        state.board[row][col + 2].fruit === fruit) {
                        
                        let endCol = col + 2;
                        while (endCol + 1 < CONFIG.COLS && 
                               state.board[row][endCol + 1].fruit === fruit) {
                            endCol++;
                        }
                        
                        const tiles = [];
                        for (let c = col; c <= endCol; c++) {
                            tiles.push({row, col: c});
                        }
                        
                        matches.push({fruit, tiles});
                        col = endCol;
                    }
                }
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã—Ö –ª–∏–Ω–∏–π
            for (let col = 0; col < CONFIG.COLS; col++) {
                for (let row = 0; row < CONFIG.ROWS - 2; row++) {
                    const fruit = state.board[row][col].fruit;
                    if (!fruit) continue;
                    
                    if (state.board[row + 1][col].fruit === fruit && 
                        state.board[row + 2][col].fruit === fruit) {
                        
                        let endRow = row + 2;
                        while (endRow + 1 < CONFIG.ROWS && 
                               state.board[endRow + 1][col].fruit === fruit) {
                            endRow++;
                        }
                        
                        const tiles = [];
                        for (let r = row; r <= endRow; r++) {
                            tiles.push({row: r, col});
                        }
                        
                        matches.push({fruit, tiles});
                        row = endRow;
                    }
                }
            }
            
            return matches;
        }

        // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –∏–≥—Ä–æ–≤–æ–≥–æ –ø–æ–ª—è
        function renderBoard() {
            DOM.gameBoard.innerHTML = '';
            DOM.gameBoard.style.gridTemplateColumns = `repeat(${CONFIG.COLS}, 1fr)`;
            
            for (let row = 0; row < CONFIG.ROWS; row++) {
                for (let col = 0; col < CONFIG.COLS; col++) {
                    const cell = document.createElement('div');
                    const tile = state.board[row][col];
                    
                    cell.className = 'cell';
                    cell.dataset.row = row;
                    cell.dataset.col = col;
                    cell.dataset.fruit = tile.fruit;
                    cell.textContent = tile.fruit;
                    
                    // –í—ã–¥–µ–ª–µ–Ω–∏–µ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–ª–µ—Ç–∫–∏
                    if (state.selectedCell && 
                        state.selectedCell.row === row && 
                        state.selectedCell.col === col) {
                        cell.classList.add('selected');
                    }
                    
                    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞
                    cell.addEventListener('click', () => handleCellClick(row, col));
                    
                    DOM.gameBoard.appendChild(cell);
                }
            }
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–∞ –ø–æ –∫–ª–µ—Ç–∫–µ
        function handleCellClick(row, col) {
            if (state.isGameOver || state.isAnimating) return;
            
            // –ï—Å–ª–∏ –∫–ª–µ—Ç–∫–∞ –Ω–µ –≤—ã–±—Ä–∞–Ω–∞ - –≤—ã–±–∏—Ä–∞–µ–º –µ—ë
            if (!state.selectedCell) {
                state.selectedCell = {row, col};
                renderBoard();
                showMessage("‚úÖ –§—Ä—É–∫—Ç –≤—ã–±—Ä–∞–Ω. –í—ã–±–µ—Ä–∏—Ç–µ —Å–æ—Å–µ–¥–Ω–∏–π —Ñ—Ä—É–∫—Ç");
                return;
            }
            
            const selected = state.selectedCell;
            
            // –ï—Å–ª–∏ –≤—ã–±—Ä–∞–Ω–∞ —Ç–∞ –∂–µ –∫–ª–µ—Ç–∫–∞ - —Å–Ω–∏–º–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ
            if (selected.row === row && selected.col === col) {
                state.selectedCell = null;
                renderBoard();
                showMessage("–í—ã–±–µ—Ä–∏—Ç–µ –ø–µ—Ä–≤—ã–π —Ñ—Ä—É–∫—Ç");
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å–µ–¥—Å—Ç–≤–∞
            if (!areNeighbors(selected, {row, col})) {
                state.selectedCell = {row, col};
                renderBoard();
                showMessage("üîÑ –í—ã–±–µ—Ä–∏—Ç–µ —Å–æ—Å–µ–¥–Ω–∏–π —Ñ—Ä—É–∫—Ç");
                return;
            }
            
            // –û–±–º–µ–Ω —Ñ—Ä—É–∫—Ç–∞–º–∏
            state.isAnimating = true;
            performSwap(selected.row, selected.col, row, col);
        }

        // –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–±–º–µ–Ω–∞ —Ñ—Ä—É–∫—Ç–∞–º–∏
        function performSwap(row1, col1, row2, col2) {
            // –ê–Ω–∏–º–∞—Ü–∏—è –æ–±–º–µ–Ω–∞
            const cell1 = document.querySelector(`.cell[data-row="${row1}"][data-col="${col1}"]`);
            const cell2 = document.querySelector(`.cell[data-row="${row2}"][data-col="${col2}"]`);
            
            if (cell1 && cell2) {
                cell1.classList.add('swapping');
                cell2.classList.add('swapping');
            }
            
            // –í—Ä–µ–º–µ–Ω–Ω—ã–π –æ–±–º–µ–Ω –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
            const temp = state.board[row1][col1].fruit;
            state.board[row1][col1].fruit = state.board[row2][col2].fruit;
            state.board[row2][col2].fruit = temp;
            
            setTimeout(() => {
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π
                const matches = findMatches();
                
                if (matches.length === 0) {
                    // –í–æ–∑–≤—Ä–∞—Ç, –µ—Å–ª–∏ –Ω–µ—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π
                    state.board[row2][col2].fruit = state.board[row1][col1].fruit;
                    state.board[row1][col1].fruit = temp;
                    
                    renderBoard();
                    state.selectedCell = null;
                    state.isAnimating = false;
                    showMessage("‚ùå –ù–µ—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë!");
                } else {
                    // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π
                    state.moves++;
                    state.combo = 1;
                    state.selectedCell = null;
                    state.isAnimating = false;
                    
                    processMatches(matches);
                    checkGameStatus();
                }
                
                updateUI();
            }, CONFIG.ANIMATION_SPEED.SWAP);
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π
        function processMatches(matches) {
            const tilesToRemove = [];
            
            // –°–±–æ—Ä –≤—Å–µ—Ö —Å–æ–≤–ø–∞–≤—à–∏—Ö –∫–ª–µ—Ç–æ–∫
            matches.forEach(match => {
                match.tiles.forEach(tile => {
                    if (!tilesToRemove.some(t => t.row === tile.row && t.col === tile.col)) {
                        tilesToRemove.push(tile);
                    }
                });
            });
            
            // –ê–Ω–∏–º–∞—Ü–∏—è –≤–∑—Ä—ã–≤–∞
            tilesToRemove.forEach((tile, index) => {
                setTimeout(() => {
                    animateExplosion(tile.row, tile.col, state.board[tile.row][tile.col].fruit);
                }, index * 30);
            });
            
            // –£–¥–∞–ª–µ–Ω–∏–µ —Ñ—Ä—É–∫—Ç–æ–≤ –∏ –ø–æ–¥—Å—á–µ—Ç –æ—á–∫–æ–≤
            setTimeout(() => {
                tilesToRemove.forEach(tile => {
                    state.board[tile.row][tile.col].fruit = null;
                });
                
                // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ—á–∫–æ–≤
                state.score += tilesToRemove.length * CONFIG.SCORE_PER_FRUIT;
                
                // –ü–∞–¥–µ–Ω–∏–µ —Ñ—Ä—É–∫—Ç–æ–≤
                dropFruits();
                fillEmptySpaces();
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ–≤—ã—Ö —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π
                const newMatches = findMatches();
                if (newMatches.length > 0) {
                    state.combo++;
                    showComboAnimation(state.combo);
                    setTimeout(() => processMatches(newMatches), 500);
                } else {
                    renderBoard();
                    updateUI();
                }
            }, tilesToRemove.length * 30 + 200);
        }

        // –ê–Ω–∏–º–∞—Ü–∏—è –≤–∑—Ä—ã–≤–∞
        function animateExplosion(row, col, fruit) {
            const cell = document.querySelector(`.cell[data-row="${row}"][data-col="${col}"]`);
            if (!cell) return;
            
            const rect = cell.getBoundingClientRect();
            const centerX = rect.left + rect.width / 2;
            const centerY = rect.top + rect.height / 2;
            
            // –ê–Ω–∏–º–∞—Ü–∏—è –∫–ª–µ—Ç–∫–∏
            cell.classList.add('exploding');
            
            // –°–æ–∑–¥–∞–Ω–∏–µ —á–∞—Å—Ç–∏—Ü
            for (let i = 0; i < 12; i++) {
                createParticle(centerX, centerY, fruit);
            }
            
            // –°–æ–∑–¥–∞–Ω–∏–µ –≤—Å–ø—ã—à–∫–∏
            createFlash();
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ —á–∞—Å—Ç–∏—Ü
        function createParticle(x, y, fruit) {
            const particle = document.createElement('div');
            particle.className = 'particle';
            particle.textContent = fruit;
            particle.style.left = `${x}px`;
            particle.style.top = `${y}px`;
            
            const angle = Math.random() * Math.PI * 2;
            const distance = 60 + Math.random() * 120;
            particle.style.setProperty('--tx', `${Math.cos(angle) * distance}px`);
            particle.style.setProperty('--ty', `${Math.sin(angle) * distance}px`);
            particle.style.setProperty('--rot', `${Math.random() * 360}deg`);
            
            document.body.appendChild(particle);
            setTimeout(() => particle.remove(), CONFIG.ANIMATION_SPEED.PARTICLE);
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ –≤—Å–ø—ã—à–∫–∏
        function createFlash() {
            const flash = document.createElement('div');
            flash.className = 'explosion-overlay';
            document.body.appendChild(flash);
            setTimeout(() => flash.remove(), 300);
        }

        // –ü–∞–¥–µ–Ω–∏–µ —Ñ—Ä—É–∫—Ç–æ–≤
        function dropFruits() {
            for (let col = 0; col < CONFIG.COLS; col++) {
                let emptyRow = CONFIG.ROWS - 1;
                
                for (let row = CONFIG.ROWS - 1; row >= 0; row--) {
                    if (state.board[row][col].fruit !== null) {
                        if (row !== emptyRow) {
                            state.board[emptyRow][col].fruit = state.board[row][col].fruit;
                            state.board[row][col].fruit = null;
                        }
                        emptyRow--;
                    }
                }
            }
        }

        // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—É—Å—Ç—ã—Ö –º–µ—Å—Ç
        function fillEmptySpaces() {
            for (let row = 0; row < CONFIG.ROWS; row++) {
                for (let col = 0; col < CONFIG.COLS; col++) {
                    if (state.board[row][col].fruit === null) {
                        state.board[row][col].fruit = getRandomFruit();
                    }
                }
            }
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –∞–Ω–∏–º–∞—Ü–∏—é –∫–æ–º–±–æ
        function showComboAnimation(combo) {
            if (combo < 2) return;
            
            const comboEl = document.createElement('div');
            comboEl.className = 'combo-text';
            comboEl.textContent = `x${combo} –ö–û–ú–ë–û!`;
            document.body.appendChild(comboEl);
            
            setTimeout(() => comboEl.remove(), 1200);
            showMessage(`üî• x${combo} –ö–û–ú–ë–û! –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ!`);
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∏–≥—Ä—ã
        function checkGameStatus() {
            if (state.moves >= CONFIG.MAX_MOVES) {
                state.isGameOver = true;
                showMessage(`üéÆ –ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞! –í–∞—à —Å—á—ë—Ç: ${state.score}`);
                
                // –ê–Ω–∏–º–∞—Ü–∏—è –æ–∫–æ–Ω—á–∞–Ω–∏—è –∏–≥—Ä—ã
                setTimeout(() => {
                    DOM.gameBoard.classList.add('game-over');
                }, 500);
            }
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–¥—Å–∫–∞–∑–∫—É
        function showHint() {
            if (state.isGameOver || state.isAnimating) return;
            
            // –ü–æ–∏—Å–∫ –≤–æ–∑–º–æ–∂–Ω–æ–≥–æ —Ö–æ–¥–∞
            for (let row = 0; row < CONFIG.ROWS; row++) {
                for (let col = 0; col < CONFIG.COLS; col++) {
                    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ –æ–±–º–µ–Ω–∞
                    if (col < CONFIG.COLS - 1) {
                        const temp = state.board[row][col].fruit;
                        state.board[row][col].fruit = state.board[row][col + 1].fruit;
                        state.board[row][col + 1].fruit = temp;
                        
                        const matches = findMatches();
                        
                        state.board[row][col + 1].fruit = state.board[row][col].fruit;
                        state.board[row][col].fruit = temp;
                        
                        if (matches.length > 0) {
                            highlightHint(row, col, row, col + 1);
                            return;
                        }
                    }
                    
                    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–≥–æ –æ–±–º–µ–Ω–∞
                    if (row < CONFIG.ROWS - 1) {
                        const temp = state.board[row][col].fruit;
                        state.board[row][col].fruit = state.board[row + 1][col].fruit;
                        state.board[row + 1][col].fruit = temp;
                        
                        const matches = findMatches();
                        
                        state.board[row + 1][col].fruit = state.board[row][col].fruit;
                        state.board[row][col].fruit = temp;
                        
                        if (matches.length > 0) {
                            highlightHint(row, col, row + 1, col);
                            return;
                        }
                    }
                }
            }
            
            showMessage("ü§î –ü–æ–¥—Å–∫–∞–∑–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞");
        }

        // –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –ø–æ–¥—Å–∫–∞–∑–∫–∏
        function highlightHint(row1, col1, row2, col2) {
            const cells = document.querySelectorAll('.cell');
            cells.forEach(cell => cell.classList.remove('selected'));
            
            const cell1 = document.querySelector(`.cell[data-row="${row1}"][data-col="${col1}"]`);
            const cell2 = document.querySelector(`.cell[data-row="${row2}"][data-col="${col2}"]`);
            
            if (cell1 && cell2) {
                cell1.classList.add('selected');
                cell2.classList.add('selected');
                showMessage("üí° –ü–æ–º–µ–Ω—è–π—Ç–µ —ç—Ç–∏ —Ñ—Ä—É–∫—Ç—ã –º–µ—Å—Ç–∞–º–∏!");
                
                setTimeout(() => {
                    cell1.classList.remove('selected');
                    cell2.classList.remove('selected');
                    state.selectedCell = null;
                    showMessage("–ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–∞–º–∏!");
                }, 3000);
            }
        }

        // ============================================
        // –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ò–ì–†–´
        // ============================================
        window.addEventListener('DOMContentLoaded', initGame);
        DOM.restartButton.addEventListener('click', initGame);
        DOM.hintButton.addEventListener('click', showHint);

        console.log("‚ú® –ò–≥—Ä–∞ –≥–æ—Ç–æ–≤–∞! –£–¥–∞—á–∏!");
    </script>
    
</body>
</html>
