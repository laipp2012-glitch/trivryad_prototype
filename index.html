<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢—Ä–∏ –≤ —Ä—è–¥ - –§—Ä—É–∫—Ç–æ–≤—ã–π –º–∞—Ç—á</title>
    <style>
        /* ============================================
           –û–°–ù–û–í–ù–´–ï –ù–ê–°–¢–†–û–ô–ö–ò –°–¢–†–ê–ù–ò–¶–´
           ============================================ */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: black;
            color: #fff;
            min-height: 100vh;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow-x: hidden;
        }
        
        /* ============================================
           –ö–û–ù–¢–ï–ô–ù–ï–† –ò –ó–ê–ì–û–õ–û–í–û–ö
           ============================================ */
        .container {
            max-width: 800px;
            width: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            margin-top: 20px;
            position: relative;
            z-index: 1;
        }
        
        h1 {
            text-align: center;
            margin-bottom: 10px;
            color: #FFD700;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }
        
        /* ============================================
           –ò–ù–§–û–†–ú–ê–¶–ò–Ø –û–ë –ò–ì–†–ï (–°–ß–ï–¢ –ò –•–û–î–´)
           ============================================ */
        .game-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            padding: 15px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            font-size: 1.2em;
        }
        
        .score, .moves {
            text-align: center;
        }
        
        .score-value, .moves-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #FFD700;
        }
        
        /* ============================================
           –ò–ì–†–û–í–û–ï –ü–û–õ–ï 8x8
           ============================================ */
        .game-board {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            gap: 5px;
            margin: 0 auto 25px;
            background-color: rgba(0, 0, 0, 0.3);
            padding: 10px;
            border-radius: 10px;
            max-width: 500px;
            position: relative;
        }
        
        /* ============================================
           –Ø–ß–ï–ô–ö–ò –° –§–†–£–ö–¢–ê–ú–ò
           ============================================ */
        .cell {
            aspect-ratio: 1;
            border-radius: 16px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            font-size: 2em;
            user-select: none;
            background-color: rgba(255, 255, 255, 0.15);
            position: relative;
            overflow: hidden;
        }
        
        /* –≠—Ñ—Ñ–µ–∫—Ç –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ –Ω–∞ —Ñ—Ä—É–∫—Ç */
        .cell:hover {
            transform: scale(1.05);
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
            background-color: rgba(255, 255, 255, 0.25);
        }
        
        /* –í—ã–¥–µ–ª–µ–Ω–Ω—ã–π —Ñ—Ä—É–∫—Ç (–ø—É–ª—å—Å–∏—Ä—É–µ—Ç) */
        .cell.selected {
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.9);
            transform: scale(1.05);
            background-color: rgba(255, 215, 0, 0.2);
            animation: pulse 1s infinite;
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 20px rgba(255, 215, 0, 0.9); }
            50% { box-shadow: 0 0 30px rgba(255, 215, 0, 0.6); }
            100% { box-shadow: 0 0 20px rgba(255, 215, 0, 0.9); }
        }
        
        /* ============================================
           –ö–ù–û–ü–ö–ò –£–ü–†–ê–í–õ–ï–ù–ò–Ø
           ============================================ */
        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }
        
        button {
            padding: 12px 25px;
            background: linear-gradient(to bottom, #FFD700, #FF8C00);
            border: none;
            border-radius: 50px;
            color: #000;
            font-weight: bold;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
        }
        
        button:active {
            transform: translateY(1px);
        }
        
        /* ============================================
           –ë–õ–û–ö –° –ü–†–ê–í–ò–õ–ê–ú–ò
           ============================================ */
        .rules {
            margin-top: 25px;
            padding: 15px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            font-size: 0.95em;
            line-height: 1.5;
        }
        
        .rules h3 {
            color: #FFD700;
            margin-bottom: 10px;
        }
        
        .rules ul {
            padding-left: 20px;
        }
        
        .rules li {
            margin-bottom: 8px;
        }
        
        /* ============================================
           –°–û–û–ë–©–ï–ù–ò–Ø –ò–ì–†–´
           ============================================ */
        .message {
            text-align: center;
            margin-top: 15px;
            font-size: 1.2em;
            height: 30px;
            color: #FFD700;
        }
        
        /* ============================================
           –ê–ù–ò–ú–ê–¶–ò–ò: –í–ó–†–´–í –§–†–£–ö–¢–û–í
           ============================================ */
        /* –ß–∞—Å—Ç–∏—Ü—ã –ø—Ä–∏ –≤–∑—Ä—ã–≤–µ */
        .particle {
            position: absolute;
            pointer-events: none;
            z-index: 1000;
            font-size: 1.2em;
            animation: particleExplode 0.7s forwards;
        }
        
        @keyframes particleExplode {
            0% {
                opacity: 1;
                transform: translate(0, 0) scale(1) rotate(0deg);
            }
            100% {
                opacity: 0;
                transform: translate(var(--tx), var(--ty)) scale(0.1) rotate(var(--rot));
            }
        }
        
    
        
        @keyframes flashEffect {
            0% { opacity: 0; transform: scale(0.5); }
            50% { opacity: 0.7; transform: scale(1.2); }
            100% { opacity: 0; transform: scale(1.5); }
        }
        
        /* ============================================
           –ê–ù–ò–ú–ê–¶–ò–ò: –¢–ï–ö–°–¢ "–ú–ê–¢–ß!"
           ============================================ */
        .match-animation {
            position: absolute;
            font-size: 2.5em;
            font-weight: bold;
            color: #FFD700;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.8);
            opacity: 0;
            z-index: 100;
            animation: matchFloat 0.7s ease-out forwards;
        }
        
        @keyframes matchFloat {
            0% {
                opacity: 0;
                transform: translateY(0) scale(0.5);
            }
            30% {
                opacity: 1;
                transform: translateY(-20px) scale(1.2);
            }
            100% {
                opacity: 0;
                transform: translateY(-50px) scale(1);
            }
        }
        
        /* ============================================
           –ê–ù–ò–ú–ê–¶–ò–ò: –ö–û–ú–ë–û
           ============================================ */
        .combo-text {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 4em;
            font-weight: bold;
            color: #FFD700;
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.9);
            opacity: 0;
            z-index: 1001;
            pointer-events: none;
            animation: comboBounce 1s ease-out;
        }
        
        @keyframes comboBounce {
            0% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.2);
            }
            20% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1.5);
            }
            40% {
                transform: translate(-50%, -50%) scale(0.9);
            }
            60% {
                transform: translate(-50%, -50%) scale(1.1);
            }
            80% {
                transform: translate(-50%, -50%) scale(0.95);
            }
            100% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(1);
            }
        }
        
        /* ============================================
           –ê–ù–ò–ú–ê–¶–ò–ò: –í–ó–†–´–í –Ø–ß–ï–ô–ö–ò –ò –û–ë–ú–ï–ù
           ============================================ */
        .cell.exploding {
            animation: cellExplode 0.3s ease-out forwards;
        }
        
        @keyframes cellExplode {
            0% {
                transform: scale(1);
                opacity: 1;
            }
            50% {
                transform: scale(1.2);
                opacity: 0.8;
            }
            100% {
                transform: scale(0);
                opacity: 0;
            }
        }
        
        .swapping {
            animation: swapAnimation 0.2s ease-out;
        }
        
        @keyframes swapAnimation {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        /* ============================================
           –ê–î–ê–ü–¢–ò–í–ù–û–°–¢–¨ –î–õ–Ø –¢–ï–õ–ï–§–û–ù–û–í
           ============================================ */
        @media (max-width: 600px) {
            .game-board {
                grid-template-columns: repeat(8, 1fr);
                gap: 4px;
            }
            
            .cell {
                font-size: 1.5em;
            }
            
            .controls {
                flex-direction: column;
                align-items: center;
            }
            
            button {
                width: 80%;
            }
            
            .combo-text {
                font-size: 2.5em;
            }
        }
    </style>
</head>
<body>
    <h1>üçé –§—Ä—É–∫—Ç–æ–≤—ã–π –º–∞—Ç—á üçå</h1>
    
    <div class="container">
        <!-- –ò–ù–§–û–†–ú–ê–¶–ò–Ø –û–ë –ò–ì–†–ï -->
        <div class="game-info">
            <div class="score">
                <div>üçì –°—á–µ—Ç</div>
                <div class="score-value">0</div>
            </div>
            <div class="moves">
                <div>üéÆ –•–æ–¥—ã</div>
                <div class="moves-value">0 / 30</div>
            </div>
        </div>
        
        <!-- –ò–ì–†–û–í–û–ï –ü–û–õ–ï -->
        <div class="game-board" id="gameBoard">
            <!-- –ó–¥–µ—Å—å –ø–æ—è–≤—è—Ç—Å—è —Ñ—Ä—É–∫—Ç—ã -->
        </div>
        
        <!-- –°–û–û–ë–©–ï–ù–ò–Ø –ò–ì–†–´ -->
        <div class="message" id="message">–í—ã–±–µ—Ä–∏—Ç–µ –ø–µ—Ä–≤—ã–π —Ñ—Ä—É–∫—Ç!</div>
        
        <!-- –ö–ù–û–ü–ö–ò –£–ü–†–ê–í–õ–ï–ù–ò–Ø -->
        <div class="controls">
            <button id="restartButton">üîÑ –ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
            <button id="hintButton">üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞</button>
        </div>
        
        <!-- –ü–†–ê–í–ò–õ–ê –ò–ì–†–´ -->
        <div class="rules">
            <h3>üéØ –ö–∞–∫ –∏–≥—Ä–∞—Ç—å:</h3>
            <ul>
                <li>üî∏ <strong>–¶–µ–ª—å:</strong> –°–æ–±–∏—Ä–∞–π—Ç–µ –ª–∏–Ω–∏–∏ –∏–∑ 3+ –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö —Ñ—Ä—É–∫—Ç–æ–≤</li>
                <li>üî∏ <strong>–•–æ–¥:</strong> –ù–∞–∂–º–∏—Ç–µ –Ω–∞ —Ñ—Ä—É–∫—Ç, –∑–∞—Ç–µ–º –Ω–∞ —Å–æ—Å–µ–¥–Ω–∏–π —Ñ—Ä—É–∫—Ç</li>
                <li>üî∏ <strong>–í–∑—Ä—ã–≤:</strong> –°–æ–±—Ä–∞–Ω–Ω—ã–µ –ª–∏–Ω–∏–∏ –≤–∑—Ä—ã–≤–∞—é—Ç—Å—è —Å —ç—Ñ—Ñ–µ–∫—Ç–∞–º–∏!</li>
                <li>üî∏ <strong>–û–∫–æ–Ω—á–∞–Ω–∏–µ:</strong> –ò–≥—Ä–∞ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ 30 —Ö–æ–¥–æ–≤</li>
            </ul>
        </div>
    </div>

    <script>
        // ============================================
        // –û–°–ù–û–í–ù–´–ï –ù–ê–°–¢–†–û–ô–ö–ò –ò–ì–†–´
        // ============================================
        const gameConfig = {
            rows: 8,               // 8 —Å—Ç—Ä–æ–∫
            cols: 8,               // 8 —Å—Ç–æ–ª–±—Ü–æ–≤
            fruits: ['üçé', 'üçå', 'üçá', 'üçä'],  // 4 –≤–∏–¥–∞ —Ñ—Ä—É–∫—Ç–æ–≤
            minMatch: 3,           // –º–∏–Ω–∏–º—É–º 3 –≤ —Ä—è–¥
            scorePerFruit: 10,     // 10 –æ—á–∫–æ–≤ –∑–∞ —Ñ—Ä—É–∫—Ç
            maxMoves: 30           // –º–∞–∫—Å–∏–º—É–º 30 —Ö–æ–¥–æ–≤
        };
        
        // ============================================
        // –°–û–°–¢–û–Ø–ù–ò–ï –ò–ì–†–´ (–≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–¥–µ—Å—å)
        // ============================================
        let game = {
            board: [],            // –∏–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ
            selectedFruit: null,  // –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ñ—Ä—É–∫—Ç
            score: 0,             // —Ç–µ–∫—É—â–∏–π —Å—á–µ—Ç
            moves: 0,             // —Å–¥–µ–ª–∞–Ω–Ω—ã–µ —Ö–æ–¥—ã
            isGameOver: false,    // –∏–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞?
            combo: 0              // —Å—á–µ—Ç—á–∏–∫ –∫–æ–º–±–æ
        };
        
        // ============================================
        // –ü–û–õ–£–ß–ï–ù–ò–ï –≠–õ–ï–ú–ï–ù–¢–û–í –ò–ó HTML
        // ============================================
        const gameBoard = document.getElementById('gameBoard');
        const scoreValue = document.querySelector('.score-value');
        const movesValue = document.querySelector('.moves-value');
        const messageEl = document.getElementById('message');
        const restartButton = document.getElementById('restartButton');
        const hintButton = document.getElementById('hintButton');
        
        // ============================================
        // –§–£–ù–ö–¶–ò–ò –î–õ–Ø –ò–ì–†–û–í–û–ì–û –ü–†–û–¶–ï–°–°–ê
        // ============================================
        
        // 1. –ó–ê–ü–£–°–ö –ù–û–í–û–ô –ò–ì–†–´
        function startNewGame() {
            console.log("üöÄ –ó–∞–ø—É—Å–∫–∞–µ–º –Ω–æ–≤—É—é –∏–≥—Ä—É!");
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
            game = {
                board: [],
                selectedFruit: null,
                score: 0,
                moves: 0,
                isGameOver: false,
                combo: 0
            };
            
            // –°–æ–∑–¥–∞–µ–º –ø—É—Å—Ç–æ–µ –ø–æ–ª–µ 8x8
            createEmptyBoard();
            
            // –ó–∞–ø–æ–ª–Ω—è–µ–º —Å–ª—É—á–∞–π–Ω—ã–º–∏ —Ñ—Ä—É–∫—Ç–∞–º–∏
            fillWithFruits();
            
            // –£–±–∏—Ä–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è
            removeStartingMatches();
            
            // –†–∏—Å—É–µ–º –ø–æ–ª–µ
            drawGameBoard();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç
            updateScoreDisplay();
            
            showMessage("üéÆ –ò–≥—Ä–∞ –Ω–∞—á–∞–ª–∞—Å—å! –í—ã–±–µ—Ä–∏—Ç–µ –ø–µ—Ä–≤—ã–π —Ñ—Ä—É–∫—Ç");
        }
        
        // 2. –°–û–ó–î–ê–ù–ò–ï –ü–£–°–¢–û–ì–û –ü–û–õ–Ø
        function createEmptyBoard() {
            game.board = [];
            for (let row = 0; row < gameConfig.rows; row++) {
                game.board[row] = [];
                for (let col = 0; col < gameConfig.cols; col++) {
                    game.board[row][col] = {
                        fruit: null,  // –∑–¥–µ—Å—å –±—É–¥–µ—Ç —Ñ—Ä—É–∫—Ç
                        row: row,
                        col: col
                    };
                }
            }
        }
        
        // 3. –ó–ê–ü–û–õ–ù–ï–ù–ò–ï –§–†–£–ö–¢–ê–ú–ò
        function fillWithFruits() {
            for (let row = 0; row < gameConfig.rows; row++) {
                for (let col = 0; col < gameConfig.cols; col++) {
                    game.board[row][col].fruit = getRandomFruit();
                }
            }
        }
        
        // 4. –ü–û–õ–£–ß–ï–ù–ò–ï –°–õ–£–ß–ê–ô–ù–û–ì–û –§–†–£–ö–¢–ê
        function getRandomFruit() {
            const randomIndex = Math.floor(Math.random() * gameConfig.fruits.length);
            return gameConfig.fruits[randomIndex];
        }
        
        // 5. –£–î–ê–õ–ï–ù–ò–ï –°–û–í–ü–ê–î–ï–ù–ò–ô –í –ù–ê–ß–ê–õ–ï
        function removeStartingMatches() {
            let hasMatches = true;
            
            while (hasMatches) {
                const matches = findMatches();
                if (matches.length === 0) {
                    hasMatches = false;
                } else {
                    // –ó–∞–º–µ–Ω—è–µ–º —Å–æ–≤–ø–∞–≤—à–∏–µ —Ñ—Ä—É–∫—Ç—ã
                    for (const match of matches) {
                        for (const tile of match.tiles) {
                            game.board[tile.row][tile.col].fruit = getRandomFruit();
                        }
                    }
                }
            }
        }
        
        // 6. –û–¢–†–ò–°–û–í–ö–ê –ò–ì–†–û–í–û–ì–û –ü–û–õ–Ø
        function drawGameBoard() {
            gameBoard.innerHTML = '';
            gameBoard.style.gridTemplateColumns = `repeat(${gameConfig.cols}, 1fr)`;
            
            for (let row = 0; row < gameConfig.rows; row++) {
                for (let col = 0; col < gameConfig.cols; col++) {
                    const tile = game.board[row][col];
                    const cell = document.createElement('div');
                    
                    cell.className = 'cell';
                    cell.dataset.row = row;
                    cell.dataset.col = col;
                    cell.textContent = tile.fruit;
                    
                    // –ö–ª–∏–∫ –ø–æ —è—á–µ–π–∫–µ
                    cell.addEventListener('click', () => handleFruitClick(row, col));
                    
                    gameBoard.appendChild(cell);
                }
            }
            
            // –í—ã–¥–µ–ª—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ñ—Ä—É–∫—Ç
            if (game.selectedFruit) {
                const {row, col} = game.selectedFruit;
                const selectedCell = document.querySelector(`.cell[data-row="${row}"][data-col="${col}"]`);
                if (selectedCell) {
                    selectedCell.classList.add('selected');
                }
            }
        }
        
        // 7. –ö–õ–ò–ö –ü–û –§–†–£–ö–¢–£
        function handleFruitClick(row, col) {
            if (game.isGameOver) return;
            
            // –ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –≤—ã–±—Ä–∞–Ω–æ - –≤—ã–±–∏—Ä–∞–µ–º
            if (!game.selectedFruit) {
                game.selectedFruit = {row, col};
                drawGameBoard();
                showMessage("‚úÖ –§—Ä—É–∫—Ç –≤—ã–±—Ä–∞–Ω. –¢–µ–ø–µ—Ä—å –≤—ã–±–µ—Ä–∏—Ç–µ —Å–æ—Å–µ–¥–Ω–∏–π —Ñ—Ä—É–∫—Ç");
                return;
            }
            
            const selectedRow = game.selectedFruit.row;
            const selectedCol = game.selectedFruit.col;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å–æ—Å–µ–¥–Ω–∏–µ –ª–∏ —Ñ—Ä—É–∫—Ç—ã
            const isNeighbor = Math.abs(row - selectedRow) + Math.abs(col - selectedCol) === 1;
            
            if (!isNeighbor) {
                // –í—ã–±–∏—Ä–∞–µ–º –Ω–æ–≤—ã–π —Ñ—Ä—É–∫—Ç
                game.selectedFruit = {row, col};
                drawGameBoard();
                showMessage("üîÑ –í—ã–±—Ä–∞–Ω –¥—Ä—É–≥–æ–π —Ñ—Ä—É–∫—Ç");
                return;
            }
            
            // –ú–µ–Ω—è–µ–º —Ñ—Ä—É–∫—Ç—ã –º–µ—Å—Ç–∞–º–∏ —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π
            animateSwap(selectedRow, selectedCol, row, col);
            swapFruits(selectedRow, selectedCol, row, col);
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è
            const matches = findMatches();
            
            if (matches.length === 0) {
                // –ï—Å–ª–∏ –Ω–µ—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π - –≤–æ–∑–≤—Ä–∞—â–∞–µ–º
                setTimeout(() => {
                    swapFruits(selectedRow, selectedCol, row, col);
                    game.selectedFruit = null;
                    drawGameBoard();
                    showMessage("‚ùå –ù–µ—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ!");
                }, 300);
            } else {
                // –ï—Å–ª–∏ –µ—Å—Ç—å —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è - –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º
                game.selectedFruit = null;
                game.moves++;
                game.combo = 1;
                
                setTimeout(() => {
                    processMatches(matches);
                    showMessage("üéâ –û—Ç–ª–∏—á–Ω—ã–π —Ö–æ–¥!");
                    checkIfGameOver();
                }, 500);
            }
            
            updateScoreDisplay();
        }
        
        // 8. –ê–ù–ò–ú–ê–¶–ò–Ø –û–ë–ú–ï–ù–ê
        function animateSwap(row1, col1, row2, col2) {
            const cell1 = document.querySelector(`.cell[data-row="${row1}"][data-col="${col1}"]`);
            const cell2 = document.querySelector(`.cell[data-row="${row2}"][data-col="${col2}"]`);
            
            if (cell1 && cell2) {
                cell1.classList.add('swapping');
                cell2.classList.add('swapping');
                
                setTimeout(() => {
                    cell1.classList.remove('swapping');
                    cell2.classList.remove('swapping');
                }, 200);
            }
        }
        
        // 9. –û–ë–ú–ï–ù –§–†–£–ö–¢–û–í
        function swapFruits(row1, col1, row2, col2) {
            const temp = game.board[row1][col1].fruit;
            game.board[row1][col1].fruit = game.board[row2][col2].fruit;
            game.board[row2][col2].fruit = temp;
        }
        
        // 10. –ü–û–ò–°–ö –°–û–í–ü–ê–î–ï–ù–ò–ô
        function findMatches() {
            const matches = [];
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–µ –ª–∏–Ω–∏–∏
            for (let row = 0; row < gameConfig.rows; row++) {
                for (let col = 0; col < gameConfig.cols - 2; col++) {
                    const fruit = game.board[row][col].fruit;
                    if (fruit && 
                        fruit === game.board[row][col+1].fruit && 
                        fruit === game.board[row][col+2].fruit) {
                        
                        let matchEnd = col + 2;
                        while (matchEnd + 1 < gameConfig.cols && 
                               game.board[row][matchEnd+1].fruit === fruit) {
                            matchEnd++;
                        }
                        
                        const tiles = [];
                        for (let c = col; c <= matchEnd; c++) {
                            tiles.push({row, col: c});
                        }
                        
                        matches.push({
                            fruit: fruit,
                            tiles: tiles,
                            direction: 'horizontal'
                        });
                        
                        col = matchEnd;
                    }
                }
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ –ª–∏–Ω–∏–∏
            for (let col = 0; col < gameConfig.cols; col++) {
                for (let row = 0; row < gameConfig.rows - 2; row++) {
                    const fruit = game.board[row][col].fruit;
                    if (fruit && 
                        fruit === game.board[row+1][col].fruit && 
                        fruit === game.board[row+2][col].fruit) {
                        
                        let matchEnd = row + 2;
                        while (matchEnd + 1 < gameConfig.rows && 
                               game.board[matchEnd+1][col].fruit === fruit) {
                            matchEnd++;
                        }
                        
                        const tiles = [];
                        for (let r = row; r <= matchEnd; r++) {
                            tiles.push({row: r, col});
                        }
                        
                        matches.push({
                            fruit: fruit,
                            tiles: tiles,
                            direction: 'vertical'
                        });
                        
                        row = matchEnd;
                    }
                }
            }
            
            return matches;
        }
        
        // 11. –í–ó–†–´–í –§–†–£–ö–¢–ê
        function explodeFruit(row, col, fruit) {
            const cell = document.querySelector(`.cell[data-row="${row}"][data-col="${col}"]`);
            if (!cell) return;
            
            const rect = cell.getBoundingClientRect();
            const centerX = rect.left + rect.width / 2;
            const centerY = rect.top + rect.height / 2;
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∞–Ω–∏–º–∞—Ü–∏—é –≤–∑—Ä—ã–≤–∞
            cell.classList.add('exploding');
            
            // –°–æ–∑–¥–∞–µ–º —á–∞—Å—Ç–∏—Ü—ã
            for (let i = 0; i < 15; i++) {
                createParticle(centerX, centerY, fruit);
            }
            
            // –≠—Ñ—Ñ–µ–∫—Ç –≤—Å–ø—ã—à–∫–∏
            createFlashEffect();
        }
        
        // 12. –°–û–ó–î–ê–ù–ò–ï –ß–ê–°–¢–ò–¶–´
        function createParticle(x, y, fruit) {
            const particle = document.createElement('div');
            particle.className = 'particle';
            particle.textContent = fruit;
            particle.style.left = `${x}px`;
            particle.style.top = `${y}px`;
            
            // –°–ª—É—á–∞–π–Ω–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
            const angle = Math.random() * Math.PI * 2;
            const distance = 50 + Math.random() * 100;
            const tx = Math.cos(angle) * distance;
            const ty = Math.sin(angle) * distance;
            const rotation = Math.random() * 360;
            
            particle.style.setProperty('--tx', `${tx}px`);
            particle.style.setProperty('--ty', `${ty}px`);
            particle.style.setProperty('--rot', `${rotation}deg`);
            
            document.body.appendChild(particle);
            
            // –£–¥–∞–ª—è–µ–º —á–µ—Ä–µ–∑ 0.7 —Å–µ–∫—É–Ω–¥
            setTimeout(() => particle.remove(), 700);
        }
        
        // 13. –°–û–ó–î–ê–ù–ò–ï –í–°–ü–´–®–ö–ò
        function createFlashEffect() {
            const flash = document.createElement('div');
            flash.className = 'explosion-overlay';
            document.body.appendChild(flash);
            
            setTimeout(() => flash.remove(), 300);
        }
        
        // 14. –û–ë–†–ê–ë–û–¢–ö–ê –°–û–í–ü–ê–î–ï–ù–ò–ô
        function processMatches(matches) {
            const tilesToRemove = [];
            
            // –°–æ–±–∏—Ä–∞–µ–º –≤—Å–µ —Ñ—Ä—É–∫—Ç—ã –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è
            for (const match of matches) {
                for (const tile of match.tiles) {
                    if (!tilesToRemove.some(t => t.row === tile.row && t.col === tile.col)) {
                        tilesToRemove.push(tile);
                    }
                }
            }
            
            // –í–∑—Ä—ã–≤–∞–µ–º –∫–∞–∂–¥—ã–π —Ñ—Ä—É–∫—Ç
            tilesToRemove.forEach((tile, index) => {
                const fruit = game.board[tile.row][tile.col].fruit;
                setTimeout(() => {
                    explodeFruit(tile.row, tile.col, fruit);
                }, index * 30);
            });
            
            // –£–¥–∞–ª—è–µ–º —Ñ—Ä—É–∫—Ç—ã –ø–æ—Å–ª–µ –∞–Ω–∏–º–∞—Ü–∏–∏
            setTimeout(() => {
                for (const tile of tilesToRemove) {
                    game.board[tile.row][tile.col].fruit = null;
                }
                
                // –î–æ–±–∞–≤–ª—è–µ–º –æ—á–∫–∏
                game.score += tilesToRemove.length * gameConfig.scorePerFruit;
                
                drawGameBoard();
                updateScoreDisplay();
                
                // –ü–∞–¥–∞—é—Ç –Ω–æ–≤—ã–µ —Ñ—Ä—É–∫—Ç—ã
                setTimeout(() => {
                    dropFruitsDown();
                    fillEmptySpaces();
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–æ–≤—ã–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è
                    const newMatches = findMatches();
                    if (newMatches.length > 0) {
                        game.combo++;
                        showComboAnimation(game.combo);
                        setTimeout(() => {
                            processMatches(newMatches);
                            showMessage(`üî• x${game.combo} –ö–û–ú–ë–û!`);
                        }, 500);
                    }
                }, 500);
            }, tilesToRemove.length * 30 + 200);
        }
        
        // 15. –ü–ê–î–ï–ù–ò–ï –§–†–£–ö–¢–û–í
        function dropFruitsDown() {
            for (let col = 0; col < gameConfig.cols; col++) {
                let emptyRow = gameConfig.rows - 1;
                
                for (let row = gameConfig.rows - 1; row >= 0; row--) {
                    if (game.board[row][col].fruit !== null) {
                        if (row !== emptyRow) {
                            game.board[emptyRow][col].fruit = game.board[row][col].fruit;
                            game.board[row][col].fruit = null;
                        }
                        emptyRow--;
                    }
                }
            }
        }
        
        // 16. –ó–ê–ü–û–õ–ù–ï–ù–ò–ï –ü–£–°–¢–´–• –ú–ï–°–¢
        function fillEmptySpaces() {
            for (let row = 0; row < gameConfig.rows; row++) {
                for (let col = 0; col < gameConfig.cols; col++) {
                    if (game.board[row][col].fruit === null) {
                        game.board[row][col].fruit = getRandomFruit();
                    }
                }
            }
            
            drawGameBoard();
        }
        
        // 17. –ê–ù–ò–ú–ê–¶–ò–Ø –ö–û–ú–ë–û
        function showComboAnimation(comboCount) {
            if (comboCount > 1) {
                const comboText = document.createElement('div');
                comboText.className = 'combo-text';
                comboText.textContent = `x${comboCount} –ö–û–ú–ë–û!`;
                
                document.body.appendChild(comboText);
                
                setTimeout(() => comboText.remove(), 1000);
            }
        }
        
        // 18. –ü–†–û–í–ï–†–ö–ê –û–ö–û–ù–ß–ê–ù–ò–Ø –ò–ì–†–´
        function checkIfGameOver() {
            if (game.moves >= gameConfig.maxMoves) {
                game.isGameOver = true;
                showMessage(`üéÆ –ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞! –í–∞—à —Å—á–µ—Ç: ${game.score}`);
            }
        }
        
        // 19. –û–ë–ù–û–í–õ–ï–ù–ò–ï –°–ß–ï–¢–ê –ù–ê –≠–ö–†–ê–ù–ï
        function updateScoreDisplay() {
            scoreValue.textContent = game.score;
            movesValue.textContent = `${game.moves} / ${gameConfig.maxMoves}`;
        }
        
        // 20. –ü–û–ö–ê–ó –°–û–û–ë–©–ï–ù–ò–ô
        function showMessage(text) {
            messageEl.textContent = text;
        }
        
        // 21. –ü–û–î–°–ö–ê–ó–ö–ê
        function showHint() {
            if (game.isGameOver) return;
            
            // –ò—â–µ–º –≤–æ–∑–º–æ–∂–Ω—ã–π —Ö–æ–¥
            for (let row = 0; row < gameConfig.rows; row++) {
                for (let col = 0; col < gameConfig.cols; col++) {
                    if (col < gameConfig.cols - 1) {
                        swapFruits(row, col, row, col + 1);
                        const matches = findMatches();
                        swapFruits(row, col, row, col + 1);
                        
                        if (matches.length > 0) {
                            highlightHint(row, col, row, col + 1);
                            return;
                        }
                    }
                    
                    if (row < gameConfig.rows - 1) {
                        swapFruits(row, col, row + 1, col);
                        const matches = findMatches();
                        swapFruits(row, col, row + 1, col);
                        
                        if (matches.length > 0) {
                            highlightHint(row, col, row + 1, col);
                            return;
                        }
                    }
                }
            }
            
            showMessage("ü§î –ü–æ–¥—Å–∫–∞–∑–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞");
        }
        
        // 22. –í–´–î–ï–õ–ï–ù–ò–ï –ü–û–î–°–ö–ê–ó–ö–ò
        function highlightHint(row1, col1, row2, col2) {
            const cell1 = document.querySelector(`.cell[data-row="${row1}"][data-col="${col1}"]`);
            const cell2 = document.querySelector(`.cell[data-row="${row2}"][data-col="${col2}"]`);
            
            if (cell1 && cell2) {
                document.querySelectorAll('.cell').forEach(cell => {
                    cell.classList.remove('selected');
                });
                
                cell1.classList.add('selected');
                cell2.classList.add('selected');
                
                showMessage("üí° –ü–æ–º–µ–Ω—è–π—Ç–µ —ç—Ç–∏ —Ñ—Ä—É–∫—Ç—ã –º–µ—Å—Ç–∞–º–∏");
                
                setTimeout(() => {
                    cell1.classList.remove('selected');
                    cell2.classList.remove('selected');
                    game.selectedFruit = null;
                    showMessage("–ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–∞–º–∏!");
                }, 3000);
            }
        }
        
        // ============================================
        // –ó–ê–ü–£–°–ö –ò–ì–†–´ –ü–†–ò –ó–ê–ì–†–£–ó–ö–ï –°–¢–†–ê–ù–ò–¶–´
        // ============================================
        window.addEventListener('DOMContentLoaded', startNewGame);
        restartButton.addEventListener('click', startNewGame);
        hintButton.addEventListener('click', showHint);
        
        console.log("‚ú® –ò–≥—Ä–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∑–∞–ø—É—Å–∫—É!");
    </script>
    
</body>
</html>
